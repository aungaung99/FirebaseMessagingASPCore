import{_registerComponent,registerVersion,getApp,_getProvider}from"https://www.gstatic.com/firebasejs/9.6.7/firebase-app.js";const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){var n=t[0]||{},t=`${this.service}/${e}`,e=this.errors[e],e=e?replaceTemplate(e,n):"Error",e=`${this.serviceName}: ${e} (${t}).`;return new FirebaseError(t,e,n)}}function replaceTemplate(e,r){return e.replace(PATTERN,(e,t)=>{var n=r[t];return null!=n?String(n):`<${t}?>`})}const PATTERN=/\{\$([^}]+)}/g;function getModularInstance(e){return e&&e._delegate?e._delegate:e}class Component{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const LONG_TYPE="type.googleapis.com/google.protobuf.Int64Value",UNSIGNED_LONG_TYPE="type.googleapis.com/google.protobuf.UInt64Value";function mapValues(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function encode(e){if(null==e)return null;if("number"==typeof(e=e instanceof Number?e.valueOf():e)&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>encode(e));if("function"==typeof e||"object"==typeof e)return mapValues(e,e=>encode(e));throw new Error("Data cannot be encoded in JSON: "+e)}function decode(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case LONG_TYPE:case UNSIGNED_LONG_TYPE:var t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t;default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>decode(e)):"function"==typeof e||"object"==typeof e?mapValues(e,e=>decode(e)):e}const FUNCTIONS_TYPE="functions",errorCodeMap={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class FunctionsError extends FirebaseError{constructor(e,t,n){super(`${FUNCTIONS_TYPE}/${e}`,t||""),this.details=n}}function codeForHTTPStatus(e){if(200<=e&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function _errorForResponse(e,t){let n=codeForHTTPStatus(e),r=n,o=void 0;try{var i=t&&t.error;if(i){const e=i.status;if("string"==typeof e){if(!errorCodeMap[e])return new FunctionsError("internal","internal");n=errorCodeMap[e],r=e}var s=i.message;"string"==typeof s&&(r=s),o=i.details,void 0!==o&&(o=decode(o))}}catch(e){}return"ok"===n?null:new FunctionsError(n,r,o)}class ContextProvider{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(e=>this.auth=e,()=>{}),this.messaging||t.get().then(e=>this.messaging=e,()=>{}),this.appCheck||n.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{var e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return this.messaging.getToken()}catch(e){return}}async getAppCheckToken(){if(this.appCheck){var e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken()}}}const DEFAULT_REGION="us-central1";function failAfter(n){let r=null;return{promise:new Promise((e,t)=>{r=setTimeout(()=>{t(new FunctionsError("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{r&&clearTimeout(r)}}}class FunctionsService{constructor(e,t,n,r,o=DEFAULT_REGION,i){this.app=e,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new ContextProvider(t,n,r),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{var s=new URL(o);this.customDomain=s.origin,this.region=DEFAULT_REGION}catch(e){this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){var t=this.app.options.projectId;return null===this.emulatorOrigin?null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`:`${this.emulatorOrigin}/${t}/${this.region}/${e}`}}function connectFunctionsEmulator$1(e,t,n){e.emulatorOrigin=`http://${t}:${n}`}function httpsCallable$1(t,n,r){return e=>call(t,n,e,r||{})}async function postJSON(e,t,n,r){n["Content-Type"]="application/json";let o;try{o=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(e){return{status:0,json:null}}let i=null;try{i=await o.json()}catch(e){}return{status:o.status,json:i}}async function call(e,t,n,r){var o=e._url(t),t={data:n=encode(n)};const i={};n=await e.contextProvider.getContext();n.authToken&&(i.Authorization="Bearer "+n.authToken),n.messagingToken&&(i["Firebase-Instance-ID-Token"]=n.messagingToken),null!==n.appCheckToken&&(i["X-Firebase-AppCheck"]=n.appCheckToken);const s=failAfter(r.timeout||7e4);t=await Promise.race([postJSON(o,t,i,e.fetchImpl),s.promise,e.cancelAllRequests]);if(s.cancel(),!t)throw new FunctionsError("cancelled","Firebase Functions instance was deleted.");e=_errorForResponse(t.status,t.json);if(e)throw e;if(!t.json)throw new FunctionsError("internal","Response is not valid JSON object.");let a=t.json.data;if(void 0===a&&(a=t.json.result),void 0===a)throw new FunctionsError("internal","Response is missing data field.");return{data:decode(a)}}const name="@firebase/functions",version="0.7.8",AUTH_INTERNAL_NAME="auth-internal",APP_CHECK_INTERNAL_NAME="app-check-internal",MESSAGING_INTERNAL_NAME="messaging-internal";function registerFunctions(i,e){_registerComponent(new Component(FUNCTIONS_TYPE,(e,{instanceIdentifier:t})=>{var n=e.getProvider("app").getImmediate(),r=e.getProvider(AUTH_INTERNAL_NAME),o=e.getProvider(MESSAGING_INTERNAL_NAME),e=e.getProvider(APP_CHECK_INTERNAL_NAME);return new FunctionsService(n,r,o,e,t,i)},"PUBLIC").setMultipleInstances(!0)),registerVersion(name,version,e),registerVersion(name,version,"esm2017")}function getFunctions(e=getApp(),t=DEFAULT_REGION){const n=_getProvider(getModularInstance(e),FUNCTIONS_TYPE);return n.getImmediate({identifier:t})}function connectFunctionsEmulator(e,t,n){connectFunctionsEmulator$1(getModularInstance(e),t,n)}function httpsCallable(e,t,n){return httpsCallable$1(getModularInstance(e),t,n)}registerFunctions(fetch.bind(self));export{connectFunctionsEmulator,getFunctions,httpsCallable};